{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nconst API_KEY = '43802076-938fa3042b8f90b237e1b6cb9';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport const fetchPhotoSearch = async (q, page, perPage = 15) => {\n    const params = {\n        q,\n        key: API_KEY,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page: perPage,\n    };\n\n    try {\n        const response = await axios.get(BASE_URL, { params });\n        return response.data; \n    } catch (error) {\n        throw new Error('Failed to fetch photos from Pixabay');\n    }\n}","export const createImagesMarkup = images => {\n  return images\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n        <li class=\"gallery-item\">\n                <a href=\"${largeImageURL}\" >\n                    <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-img\" />\n                </a>\n                <div class=\"details\">\n        <div class=\"detail-row\">\n            <p>Likes:</p>\n            <span>${likes}</span>\n        </div>\n        <div class=\"detail-row\">\n            <p>Views:</p>\n            <span>${views}</span>\n        </div>\n        <div class=\"detail-row\">\n            <p>Comments:</p>\n            <span>${comments}</span>\n        </div>\n        <div class=\"detail-row\">\n            <p>Downloads:</p>\n            <span>${downloads}</span>\n        </div>\n    </div>\n            </li>\n        `\n    )\n    .join('');\n};","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport {fetchPhotoSearch} from './js/pixabay-api.js';\nimport {createImagesMarkup} from './js/render-functions.js';\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst searchRes = document.querySelector('.gallery');\nconst loaderEl = document.querySelector('.js-loader');\nconst loadMoreBtnEl = document.querySelector('.load-more-button');\n\n\nlet currentPage = 1;\nlet currentSearchQuery = '';\n\nasync function onSearchFormSubmit(event) {\n    event.preventDefault();\n    currentPage = 1;\n    currentSearchQuery = event.target.querySelector('.search-input').value.trim();\n\n    if (currentSearchQuery === '') {\n        searchRes.innerHTML = '';\n        event.target.reset();\n        iziToast.error({\n            title: 'Error',\n            message: 'Illegal operation, enter a name',\n            position: 'topRight',\n        });\n        return;\n    }\n    \n    searchRes.innerHTML = '';\n    loaderEl.classList.remove('is-hidden');\n\ntry {\n    const imagesData = await fetchPhotoSearch(currentSearchQuery, currentPage)\n    if (imagesData.total === 0 || !imagesData.hits) {\n        iziToast.error({\n            title: 'Error',\n            message: 'Sorry, there are no images matching your search query. Please try again!',\n            position: 'topRight',\n        });\n        return;\n        }\n    searchRes.innerHTML = createImagesMarkup(imagesData.hits);\n    new SimpleLightbox('.gallery a', {\n        captions: true,\n        captionDelay: 250,\n        captionPosition: 'bottom',\n    }).refresh();\n    loadMoreBtnEl.classList.remove('is-hidden');\n} catch (error) {\n    console.log(error);\n}\nevent.target.reset();\nloaderEl.classList.add('is-hidden');\n}\nconst smoothScroll = () => {\n    const galleryItem = document.querySelector('.gallery-item');\n    const imageHeight = galleryItem.getBoundingClientRect().height;\n    const scrollHeight = imageHeight * 2;\n    console.log(scrollHeight);\n    window.scrollBy({\n    top: imageHeight,\n    left: 0,\n    behavior: 'smooth',\n});\n};\nasync function loadMoreImages() {\n    currentPage++;\n    try {\n        loaderEl.classList.remove('is-hidden');\n        const imagesData = await fetchPhotoSearch(currentSearchQuery, currentPage);\n        if (imagesData.total === 0 || !imagesData.hits) {\n            iziToast.error({\n                title: 'Error',\n                message: 'Sorry, there are no more images to load.',\n                position: 'topRight',\n            });\n            return;\n        }\n        const newImagesMarkup = createImagesMarkup(imagesData.hits);\n        searchRes.insertAdjacentHTML('beforeend', newImagesMarkup);\n        new SimpleLightbox('.gallery a', {\n            captions: true,\n            captionDelay: 250,\n            captionPosition: 'bottom',\n        }).refresh();\n        \n          if (currentPage * 15 >= imagesData.totalHits) {\n            loadMoreBtnEl.classList.add('is-hidden');\n            iziToast.info({\n                title: 'Info',\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n            });\n        }\n        smoothScroll();\n\n    } catch (error) {\n        console.log(error);\n    } finally {\n        loaderEl.classList.add('is-hidden'); \n    }\n}\n\nloadMoreBtnEl.addEventListener('click', loadMoreImages);\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);"],"names":["API_KEY","BASE_URL","fetchPhotoSearch","q","page","perPage","params","axios","createImagesMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchFormEl","searchRes","loaderEl","loadMoreBtnEl","currentPage","currentSearchQuery","onSearchFormSubmit","event","iziToast","imagesData","SimpleLightbox","error","smoothScroll","imageHeight","scrollHeight","loadMoreImages","newImagesMarkup"],"mappings":"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"}